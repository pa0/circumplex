<!-- analiza struktury kołowej -->

Aby sprawdzić, czy struktura **Circular Scale of Interpersonal Values (CSIV)** jest spójna z modelem kołowym, możesz wykorzystać **R** do przeprowadzenia analiz, które pozwolą ocenić, czy dane pasują do teoretycznego modelu kołowego. Poniżej przedstawiam kroki, które możesz podjąć, oraz przykłady kodu w R.

---

### 1. **Przygotowanie danych**
   - Załaduj dane do R i upewnij się, że są odpowiednio przygotowane (braki danych, skalowanie itp.).
   - Jeśli masz wiele zmiennych, upewnij się, że są one zgodne z wymiarami teoretycznymi modelu kołowego.

```{r}
# Przykład załadowania danych
data <- dane |> dplyr::select(matches("CSIV.*[0-9]$"))

# Sprawdź strukturę danych
str(data)

# Usuń braki danych (jeśli są)
data <- na.omit(data)
```

---

### 2. **Analiza czynnikowa eksploracyjna (EFA)**
   - EFA pozwala na eksplorację struktury czynnikowej bez zakładania wcześniejszych założeń. Możesz użyć jej, aby sprawdzić, czy czynniki wyłaniają się zgodnie z modelem kołowym.

```{r}
# Załaduj potrzebne biblioteki
library(psych)

# Przeprowadź EFA
efa_result <- fa(data, nfactors = 2, rotate = "oblimin")  # Dostosuj nfactors do liczby teoretycznych wymiarów
print(efa_result)

# Wizualizacja wyników EFA
fa.diagram(efa_result)
```

   - **Interpretacja**: Sprawdź, czy czynniki odpowiadają teoretycznym wymiarom modelu kołowego. Jeśli tak, to jest to wstępne potwierdzenie spójności.

---

### 3. **Analiza czynnikowa konfirmacyjna (CFA)**
   - CFA pozwala na testowanie, czy dane pasują do określonego modelu teoretycznego (w tym przypadku modelu kołowego).
   - Użyj pakietu **lavaan** do przeprowadzenia CFA.

```{r}
# Załaduj bibliotekę lavaan
library(lavaan)

# Zdefiniuj model teoretyczny (dostosuj do swojego przypadku)
model <- '
  # Definiuj czynniki i ich wskaźniki
  Wymiar1 =~ item1 + item2 + item3
  Wymiar2 =~ item4 + item5 + item6
  Wymiar3 =~ item7 + item8 + item9
  # Dodaj korelacje między wymiarami, jeśli są przewidywane w modelu kołowym
  Wymiar1 ~~ Wymiar2
  Wymiar2 ~~ Wymiar3
  Wymiar3 ~~ Wymiar1
'

# Przeprowadź CFA
cfa_result <- cfa(model, data = data)
summary(cfa_result, fit.measures = TRUE, standardized = TRUE)

# Wizualizacja modelu
library(semPlot)
semPaths(cfa_result, what = "std", layout = "circle")  # Użyj layout = "circle" dla modelu kołowego
```

   - **Interpretacja**: Sprawdź wskaźniki dopasowania modelu (np. CFI, TLI, RMSEA). Jeśli wartości są w akceptowalnych zakresach (CFI/TLI > 0.90, RMSEA < 0.08), model jest dobrze dopasowany.

---

### 4. **Analiza struktury kołowej**
   - Aby bezpośrednio przetestować, czy dane pasują do modelu kołowego, możesz użyć **analizy circumplexu** (circumplex analysis). Pakiet **circular** w R może być pomocny.

```{r}
# Załaduj bibliotekę circular
library(circular)

# Przygotuj dane do analizy circumplexu
angles <- circular(data$angle, units = "degrees")  # angle to teoretyczne kąty w modelu kołowym

# Wizualizacja circumplexu
plot(angles, stack = TRUE, bins = 360, col = "blue")
```

   - **Interpretacja**: Sprawdź, czy punkty danych układają się w okręgu zgodnie z modelem kołowym.

---

### 5. **Testowanie hipotez o strukturze kołowej**
   - Możesz również użyć testów statystycznych, aby sprawdzić, czy dane pasują do modelu kołowego. Na przykład:
     - **Test zgodności rozkładu kołowego**: Sprawdź, czy rozkład danych jest zgodny z modelem kołowym.
     - **Test korelacji między wymiarami**: Sprawdź, czy korelacje między wymiarami są zgodne z teoretycznym modelem kołowym.

```{r}
# Test zgodności rozkładu kołowego
rayleigh.test(angles)

# Test korelacji między wymiarami
correlation_matrix <- cor(data)
print(correlation_matrix)
```

---

### 6. **Wizualizacja wyników**
   - Wizualizacja jest kluczowa do zrozumienia, czy dane pasują do modelu kołowego. Możesz użyć pakietów **ggplot2** lub **plotly** do stworzenia wykresów kołowych.

```{r}
# Przykład wizualizacji circumplexu z ggplot2
library(ggplot2)

ggplot(data, aes(x = Wymiar1, y = Wymiar2)) +
  geom_point() +
  coord_fixed() +
  theme_minimal() +
  labs(title = "Circumplex Model of CSIV", x = "Wymiar 1", y = "Wymiar 2")
```

---

### Podsumowanie
Aby sprawdzić, czy struktura CSIV jest spójna z modelem kołowym, możesz:
1. Przeprowadzić **EFA** i **CFA**, aby ocenić strukturę czynnikową.
2. Użyć **analizy circumplexu**, aby zwizualizować dane w kontekście kołowym.
3. Przeprowadzić testy statystyczne, aby ocenić zgodność z modelem kołowym.

Pamiętaj, że wyniki powinny być interpretowane w kontekście teoretycznym, a wszelkie odstępstwa od modelu kołowego powinny być dokładnie przeanalizowane.